# Twogether - æƒ…ä¾¶è¦ªå¯†è¿½è¹¤æ‡‰ç”¨

ä¸€å€‹ç¾ä»£åŒ–çš„æƒ…ä¾¶è¦ªå¯†é—œä¿‚è¿½è¹¤æ‡‰ç”¨ï¼Œå¹«åŠ©æƒ…ä¾¶è¨˜éŒ„ç¾å¥½æ™‚å…‰ã€å»ºç«‹è¦ªå¯†é€£æ¥ï¼Œä¸¦é€šééŠæˆ²åŒ–çš„æ–¹å¼å¢é€²æ„Ÿæƒ…ã€‚

## ğŸŒŸ åŠŸèƒ½ç‰¹è‰²

### æ ¸å¿ƒåŠŸèƒ½
- **æ„›çš„æ™‚å…‰è¨˜éŒ„** - è¨˜éŒ„è¦ªå¯†æ™‚åˆ»ï¼ŒåŒ…å«æ—¥æœŸã€æ™‚é–“ã€å¿ƒæƒ…ã€ç…§ç‰‡å’Œè©³ç´°æè¿°
- **æ™ºèƒ½æš±ç¨±ç³»çµ±** - å€‹æ€§åŒ–çš„æš±ç¨±è¨­å®šï¼Œè®“è¨˜éŒ„æ›´åŠ æº«é¦¨
- **ç…§ç‰‡ç®¡ç†** - ä¸Šå‚³å’Œç®¡ç†ç¾å¥½å›æ†¶çš„ç…§ç‰‡
- **æ•¸æ“šæŒä¹…åŒ–** - å®Œæ•´çš„å¾Œç«¯æ•¸æ“šåº«æ”¯æŒï¼Œæ•¸æ“šæ°¸ä¸ä¸Ÿå¤±

### é€²éšåŠŸèƒ½
- **æˆå°±å¾½ç« ç³»çµ±** - è§£é–å„ç¨®æƒ…ä¾¶æˆå°±ï¼Œå¢åŠ è¶£å‘³æ€§
- **æ„›æƒ…ç¡¬å¹£** - é€šéè¨˜éŒ„ç²å¾—ç¡¬å¹£ï¼Œå…Œæ›ç‰¹æ®Šçå‹µ
- **è§’è‰²æ‰®æ¼”æ¨¡å¼** - å…§å»ºå¤šç¨®æƒ…è¶£åŠ‡æœ¬ï¼Œå¢åŠ ç”Ÿæ´»æ¨‚è¶£
- **çµ±è¨ˆåˆ†æ** - è©³ç´°çš„è¦ªå¯†åº¦çµ±è¨ˆå’Œè¶¨å‹¢åˆ†æ
- **æ—¥æ›†è¦–åœ–** - ç›´è§€çš„æœˆæ›†é¡¯ç¤ºæ‰€æœ‰é‡è¦æ™‚åˆ»

## ğŸ—ï¸ æŠ€è¡“æ¶æ§‹

### å‰ç«¯ (Frontend)
- **æ¡†æ¶**: React 18 + TypeScript + Vite
- **æ¨£å¼**: Tailwind CSS
- **åœ–æ¨™**: Lucide React
- **ç‹€æ…‹ç®¡ç†**: React Hooks (useState, useEffect, useCallback)
- **APIé›†æˆ**: Axios + é›™æ¨¡å¼æ”¯æŒ (localStorage/Backend API)
- **éŸ¿æ‡‰å¼è¨­è¨ˆ**: å®Œå…¨é©é…ç§»å‹•ç«¯å’Œæ¡Œé¢ç«¯

### å¾Œç«¯ (Backend)
- **èªè¨€**: Rust
- **æ¡†æ¶**: Axum (ç¾ä»£ç•°æ­¥Webæ¡†æ¶)
- **æ•¸æ“šåº«**: PostgreSQL 15
- **ORM**: SQLx (ç·¨è­¯æ™‚æª¢æŸ¥çš„SQLæŸ¥è©¢)
- **èªè­‰**: JWT (JSON Web Tokens)
- **APIè¨­è¨ˆ**: RESTful API

### æ•¸æ“šåº«æ¶æ§‹
- **ç”¨æˆ¶ç®¡ç†**: ç”¨æˆ¶è¨»å†Šã€ç™»éŒ„ã€é…å°ç³»çµ±
- **æ„›çš„æ™‚å…‰**: å®Œæ•´çš„è¦ªå¯†è¨˜éŒ„å­˜å„²
- **æˆå°±ç³»çµ±**: å¾½ç« å’Œé‡Œç¨‹ç¢‘è¿½è¹¤
- **ç¡¬å¹£ç³»çµ±**: äº¤æ˜“è¨˜éŒ„å’Œé¤˜é¡ç®¡ç†
- **ç…§ç‰‡å­˜å„²**: æ–‡ä»¶ç®¡ç†å’Œå…ƒæ•¸æ“šå­˜å„²

## ğŸš€ å¿«é€Ÿé–‹å§‹

### ç’°å¢ƒè¦æ±‚
- Node.js 18+ (å‰ç«¯)
- Rust 1.70+ (å¾Œç«¯)
- PostgreSQL 15+ (æ•¸æ“šåº«)
- Docker & Docker Compose (å¯é¸ï¼Œç”¨æ–¼é–‹ç™¼ç’°å¢ƒ)

### ä½¿ç”¨ Docker Compose (æ¨è–¦)

```bash
# å…‹éš†é …ç›®
git clone <repository-url>
cd Twogether

# å•Ÿå‹•å®Œæ•´é–‹ç™¼ç’°å¢ƒ
docker-compose up -d

# è¨ªå•æ‡‰ç”¨
# å‰ç«¯: http://localhost:5173
# å¾Œç«¯ API: http://localhost:8080
# æ•¸æ“šåº«ç®¡ç†: http://localhost:5050 (pgAdmin)
```

### æ‰‹å‹•å®‰è£

#### 1. æ•¸æ“šåº«è¨­ç½®
```bash
# å®‰è£ä¸¦å•Ÿå‹• PostgreSQL
createdb twogether_dev
```

#### 2. å¾Œç«¯è¨­ç½®
```bash
cd backend

# å®‰è£ SQLx CLI
cargo install sqlx-cli --features postgres

# è¨­ç½®ç’°å¢ƒè®Šé‡
export DATABASE_URL="postgresql://username:password@localhost:5432/twogether_dev"

# é‹è¡Œæ•¸æ“šåº«é·ç§»
sqlx migrate run

# å•Ÿå‹•å¾Œç«¯æœå‹™
cargo run
```

#### 3. å‰ç«¯è¨­ç½®
```bash
cd frontend

# å®‰è£ä¾è³´
npm install

# å•Ÿå‹•é–‹ç™¼æœå‹™å™¨
npm run dev
```

## ğŸš€ To start the development servers:

```bash
# Option 1: Use our convenient script
./scripts/dev-start.sh backend    # Terminal 1
./scripts/dev-start.sh frontend   # Terminal 2

# Option 2: Manual startup
cd backend && DATABASE_URL="postgresql://twogether:twogether_dev_password@localhost:5432/twogether_dev" cargo run
cd frontend && npm run dev
```

## ğŸ“‹ View Logs

### Backend Logs
```bash
# If running with cargo run - check the terminal where backend is running
# If using Docker Compose:
docker compose logs backend
docker compose logs -f backend  # Follow logs in real-time
```

### Frontend Logs  
```bash
# If running with npm run dev - check the terminal where frontend is running
# If using Docker Compose:
docker compose logs frontend
docker compose logs -f frontend  # Follow logs in real-time
```

### Database Logs
```bash
docker compose logs postgres
docker compose logs -f postgres  # Follow logs in real-time
```

### All Container Logs
```bash
docker compose logs           # All logs
docker compose logs -f        # Follow all logs in real-time
docker compose logs --tail=50 # Last 50 lines from all services
```

## ğŸ”§ Process Management

### Check Running Processes
```bash
# Check what's running on port 8080
lsof -i :8080

# Check all Twogether processes  
ps aux | grep twogether

# Check Docker containers
docker compose ps
```

### Kill Processes
```bash
# Kill specific process by PID
kill <PID>

# Kill all processes on port 8080
lsof -ti:8080 | xargs kill -9

# Kill by process name
pkill -f twogether-backend

# Stop Docker containers
docker compose down
```

### Troubleshooting "Address already in use"
```bash
# 1. Check what's using the port
lsof -i :8080

# 2. Kill the process
kill <PID_from_step_1>

# 3. Or kill all processes on port 8080
lsof -ti:8080 | xargs kill -9

# 4. Then restart your service
cd backend && DATABASE_URL="postgresql://twogether:twogether_dev_password@localhost:5432/twogether_dev" cargo run
```

## ğŸ“ é …ç›®çµæ§‹

```
Twogether/
â”œâ”€â”€ frontend/                 # React å‰ç«¯æ‡‰ç”¨
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ components/       # React çµ„ä»¶
â”‚   â”‚   â”œâ”€â”€ services/         # API æœå‹™å±¤
â”‚   â”‚   â””â”€â”€ App.tsx          # ä¸»æ‡‰ç”¨çµ„ä»¶
â”‚   â”œâ”€â”€ public/              # éœæ…‹è³‡æº
â”‚   â””â”€â”€ package.json         # å‰ç«¯ä¾è³´
â”œâ”€â”€ backend/                 # Rust å¾Œç«¯ API
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ routes/          # API è·¯ç”±
â”‚   â”‚   â”œâ”€â”€ models/          # æ•¸æ“šæ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ services/        # æ¥­å‹™é‚è¼¯
â”‚   â”‚   â””â”€â”€ main.rs          # å¾Œç«¯å…¥å£
â”‚   â”œâ”€â”€ migrations/          # æ•¸æ“šåº«é·ç§»
â”‚   â””â”€â”€ Cargo.toml           # å¾Œç«¯ä¾è³´
â”œâ”€â”€ docker-compose.yml       # é–‹ç™¼ç’°å¢ƒç·¨æ’
â””â”€â”€ README.md               # é …ç›®æ–‡æª”
```

## ğŸ”§ é–‹ç™¼æŒ‡å—

### API ç«¯é»

#### èªè­‰
- `POST /api/auth/register` - ç”¨æˆ¶è¨»å†Š
- `POST /api/auth/login` - ç”¨æˆ¶ç™»éŒ„
- `GET /api/auth/me` - ç²å–ç”¨æˆ¶ä¿¡æ¯

#### æ„›çš„æ™‚å…‰
- `GET /api/love-moments` - ç²å–è¨˜éŒ„åˆ—è¡¨
- `POST /api/love-moments` - å‰µå»ºæ–°è¨˜éŒ„
- `GET /api/love-moments/:id` - ç²å–å–®å€‹è¨˜éŒ„
- `GET /api/love-moments/stats` - ç²å–çµ±è¨ˆæ•¸æ“š

#### å…¶ä»–åŠŸèƒ½
- `GET /api/achievements` - ç²å–æˆå°±åˆ—è¡¨
- `GET /api/coins/balance` - ç²å–ç¡¬å¹£é¤˜é¡
- `POST /api/photos` - ä¸Šå‚³ç…§ç‰‡

### å‰ç«¯æ¶æ§‹ç‰¹é»

#### å®Œæ•´å¾Œç«¯ API é›†æˆ
```typescript
// å®Œå…¨ä½¿ç”¨å¾Œç«¯ API é€²è¡Œæ•¸æ“šç®¡ç†
const response = await apiClient.get('/love-moments');
return response.data.map(transformApiRecord);

// åŒ…å«éŒ¯èª¤è™•ç†å’Œç”¨æˆ¶å‹å¥½æç¤º
try {
  await apiService.createIntimateRecord(data);
} catch (error) {
  showNotification({
    type: 'warning',
    title: 'è¨˜éŒ„å¤±æ•—',
    message: 'ç„¡æ³•ä¿å­˜è¨˜éŒ„ï¼Œè«‹ç¨å¾Œå†è©¦'
  });
}
```

#### çµ„ä»¶åŒ–è¨­è¨ˆ
- `SettingsView.tsx` - è¨­ç½®é é¢çµ„ä»¶
- `RoleplayView.tsx` - è§’è‰²æ‰®æ¼”çµ„ä»¶
- é¿å…çµ„ä»¶å…§éƒ¨å®šç¾©ï¼Œé˜²æ­¢é‡è¤‡æ¸²æŸ“

### å¾Œç«¯æ¶æ§‹ç‰¹é»

#### é¡å‹å®‰å…¨çš„ SQL
```rust
// ç·¨è­¯æ™‚æª¢æŸ¥çš„ SQL æŸ¥è©¢
let moments = sqlx::query!(
    "SELECT * FROM love_moments WHERE couple_id = $1",
    couple_id
).fetch_all(&pool).await?;
```

#### ç¾ä»£ Rust ç•°æ­¥
```rust
// åŸºæ–¼ Tokio çš„ç•°æ­¥è™•ç†
#[tokio::main]
async fn main() -> Result<()> {
    let app = create_app().await?;
    axum::Server::bind(&addr).serve(app).await?;
}
```

## ğŸ¯ æ ¸å¿ƒåŠŸèƒ½æ¼”ç¤º

### 1. æ„›çš„æ™‚å…‰è¨˜éŒ„
- æ—¥æœŸæ™‚é–“é¸æ“‡
- å¿ƒæƒ…è¡¨æƒ…é¸æ“‡
- è©³ç´°æè¿°å’Œå‚™è¨»
- ç…§ç‰‡ä¸Šå‚³å’Œé è¦½
- åœ°é»å’ŒæŒçºŒæ™‚é–“è¨˜éŒ„

### 2. æ•¸æ“šå¯è¦–åŒ–
- æœˆåº¦çµ±è¨ˆåœ–è¡¨
- è¦ªå¯†åº¦è¶¨å‹¢åˆ†æ
- æˆå°±é€²åº¦è¿½è¹¤
- ç¡¬å¹£ç²å¾—æ­·å²

### 3. éŠæˆ²åŒ–å…ƒç´ 
- é€£çºŒè¨˜éŒ„çå‹µ
- æˆå°±å¾½ç« è§£é–
- æ„›æƒ…ç¡¬å¹£ç³»çµ±
- ç­‰ç´šæå‡æ©Ÿåˆ¶

## ğŸ”’ å®‰å…¨ç‰¹æ€§

- JWT èº«ä»½é©—è­‰
- PostgreSQL åƒæ•¸åŒ–æŸ¥è©¢é˜²æ­¢ SQL æ³¨å…¥
- CORS è·¨åŸŸä¿è­·
- å¯†ç¢¼å“ˆå¸Œå­˜å„²
- ç”¨æˆ¶æ•¸æ“šéš”é›¢

## ğŸ“Š æ€§èƒ½å„ªåŒ–

- React useCallback é˜²æ­¢ä¸å¿…è¦é‡æ¸²æŸ“
- PostgreSQL ç´¢å¼•å„ªåŒ–
- åœ–ç‰‡å£“ç¸®å’Œå„ªåŒ–
- ç•°æ­¥æ•¸æ“šåŠ è¼‰
- éŸ¿æ‡‰å¼åœ–ç‰‡è™•ç†

## ğŸ¤ è²¢ç»æŒ‡å—

1. Fork é …ç›®
2. å‰µå»ºåŠŸèƒ½åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. é–‹å•Ÿ Pull Request

## ğŸ“„ è¨±å¯è­‰

æœ¬é …ç›®ä½¿ç”¨ MIT è¨±å¯è­‰ - æŸ¥çœ‹ [LICENSE](LICENSE) æ–‡ä»¶äº†è§£è©³æƒ…ã€‚

## ğŸ™ è‡´è¬

- React ç¤¾å€æä¾›çš„å„ªç§€ç”Ÿæ…‹ç³»çµ±
- Rust ç¤¾å€çš„ Axum å’Œ SQLx é …ç›®
- Tailwind CSS çš„ç¾è§€è¨­è¨ˆç³»çµ±
- PostgreSQL çš„å¯é æ•¸æ“šå­˜å„²

---

**è®“æ„›æƒ…æ›´æœ‰è¶£ï¼Œè®“å›æ†¶æ›´çè²´** â¤ï¸ 