# Twogether - æƒ…ä¾¶è¦ªå¯†è¿½è¹¤æ‡‰ç”¨

ä¸€å€‹ç¾ä»£åŒ–çš„æƒ…ä¾¶è¦ªå¯†é—œä¿‚è¿½è¹¤æ‡‰ç”¨ï¼Œå¹«åŠ©æƒ…ä¾¶è¨˜éŒ„ç¾å¥½æ™‚å…‰ã€å»ºç«‹è¦ªå¯†é€£æ¥ï¼Œä¸¦é€šééŠæˆ²åŒ–çš„æ–¹å¼å¢é€²æ„Ÿæƒ…ã€‚

## ğŸŒŸ åŠŸèƒ½ç‰¹è‰²

### æ ¸å¿ƒåŠŸèƒ½
- **æ„›çš„æ™‚å…‰è¨˜éŒ„** - è¨˜éŒ„è¦ªå¯†æ™‚åˆ»ï¼ŒåŒ…å«æ—¥æœŸã€æ™‚é–“ã€å¿ƒæƒ…ã€ç…§ç‰‡å’Œè©³ç´°æè¿°
- **æ™ºèƒ½æš±ç¨±ç³»çµ±** - å€‹æ€§åŒ–çš„æš±ç¨±è¨­å®šï¼Œè®“è¨˜éŒ„æ›´åŠ æº«é¦¨
- **ç…§ç‰‡ç®¡ç†** - ä¸Šå‚³å’Œç®¡ç†ç¾å¥½å›æ†¶çš„ç…§ç‰‡
- **æ•¸æ“šæŒä¹…åŒ–** - å®Œæ•´çš„å¾Œç«¯æ•¸æ“šåº«æ”¯æŒï¼Œæ•¸æ“šæ°¸ä¸ä¸Ÿå¤±

### é€²éšåŠŸèƒ½
- **æˆå°±å¾½ç« ç³»çµ±** - è§£é–å„ç¨®æƒ…ä¾¶æˆå°±ï¼Œå¢åŠ è¶£å‘³æ€§
- **æ„›æƒ…ç¡¬å¹£** - é€šéè¨˜éŒ„ç²å¾—ç¡¬å¹£ï¼Œå…Œæ›ç‰¹æ®Šçå‹µ
- **è§’è‰²æ‰®æ¼”æ¨¡å¼** - å…§å»ºå¤šç¨®æƒ…è¶£åŠ‡æœ¬ï¼Œå¢åŠ ç”Ÿæ´»æ¨‚è¶£
- **çµ±è¨ˆåˆ†æ** - è©³ç´°çš„è¦ªå¯†åº¦çµ±è¨ˆå’Œè¶¨å‹¢åˆ†æ
- **æ—¥æ›†è¦–åœ–** - ç›´è§€çš„æœˆæ›†é¡¯ç¤ºæ‰€æœ‰é‡è¦æ™‚åˆ»

## ğŸ—ï¸ æŠ€è¡“æ¶æ§‹

### å‰ç«¯ (Frontend)
- **æ¡†æ¶**: React 18 + TypeScript + Vite
- **æ¨£å¼**: Tailwind CSS
- **åœ–æ¨™**: Lucide React
- **ç‹€æ…‹ç®¡ç†**: React Hooks (useState, useEffect, useCallback)
- **APIé›†æˆ**: Axios + é›™æ¨¡å¼æ”¯æŒ (localStorage/Backend API)
- **éŸ¿æ‡‰å¼è¨­è¨ˆ**: å®Œå…¨é©é…ç§»å‹•ç«¯å’Œæ¡Œé¢ç«¯

### å¾Œç«¯ (Backend)
- **èªè¨€**: Rust
- **æ¡†æ¶**: Axum (ç¾ä»£ç•°æ­¥Webæ¡†æ¶)
- **æ•¸æ“šåº«**: PostgreSQL 15
- **ORM**: SQLx (ç·¨è­¯æ™‚æª¢æŸ¥çš„SQLæŸ¥è©¢)
- **èªè­‰**: JWT (JSON Web Tokens)
- **APIè¨­è¨ˆ**: RESTful API

### æ•¸æ“šåº«æ¶æ§‹
- **ç”¨æˆ¶ç®¡ç†**: ç”¨æˆ¶è¨»å†Šã€ç™»éŒ„ã€é…å°ç³»çµ±
- **æ„›çš„æ™‚å…‰**: å®Œæ•´çš„è¦ªå¯†è¨˜éŒ„å­˜å„²
- **æˆå°±ç³»çµ±**: å¾½ç« å’Œé‡Œç¨‹ç¢‘è¿½è¹¤
- **ç¡¬å¹£ç³»çµ±**: äº¤æ˜“è¨˜éŒ„å’Œé¤˜é¡ç®¡ç†
- **ç…§ç‰‡å­˜å„²**: æ–‡ä»¶ç®¡ç†å’Œå…ƒæ•¸æ“šå­˜å„²

## ğŸ¯ æœ€æ–°æ”¹é€²

### âœ… **å¢å¼·æ—¥èªŒè¨˜éŒ„èˆ‡éŒ¯èª¤è™•ç†**
- è©³ç´°çš„è«‹æ±‚/éŸ¿æ‡‰æ—¥èªŒè¨˜éŒ„ï¼ŒåŒ…å«åŸ·è¡Œæ™‚é–“
- ä¸­è‹±æ–‡å‹å¥½çš„éŒ¯èª¤æç¤ºä¿¡æ¯
- çµæ§‹åŒ–æ—¥èªŒï¼Œæ”¯æŒå¤šç¨®ç´šåˆ¥ (debug, info, warn, error)
- æ—¥èªŒæ–‡ä»¶è¼¸å‡º (`logs/backend.log`, `logs/frontend.log`) ä¾¿æ–¼èª¿è©¦
- æ”¹é€²çš„ API éŒ¯èª¤è™•ç†ï¼Œæä¾›å…·é«”éŒ¯èª¤ä»£ç¢¼å’Œç”¨æˆ¶å‹å¥½æ¶ˆæ¯

### âœ… **æ”¹é€²ç”¨æˆ¶ç•Œé¢**
- ç™»éŒ„/è¨»å†Šç§»è‡³å³ä¸Šè§’æ¨™é ­ (ç¬¦åˆè¡Œæ¥­æ¨™æº–)
- å°ˆæ¥­çš„æ¨™é ­çµ„ä»¶ï¼ŒåŒ…å«ç”¨æˆ¶ä¸‹æ‹‰èœå–®
- å¢å¼·çš„é€šçŸ¥ç³»çµ±ï¼Œæ›´å¥½çš„éŒ¯èª¤é¡¯ç¤º
- æ¸…æ™°çš„æ¨¡å¡ŠåŒ–çµ„ä»¶åˆ†é›¢
- æ›´å¥½çš„éŸ¿æ‡‰å¼è¨­è¨ˆå’Œå¯è¨ªå•æ€§

### âœ… **Supabase é›²ç«¯å­˜å„²é›†æˆ**
- ç…§ç‰‡å­˜å„²å¾æ•¸æ“šåº« BLOB é·ç§»åˆ° Supabase é›²ç«¯å­˜å„²
- æ›´å¥½çš„æ€§èƒ½å’Œå¯æ“´å±•æ€§
- å…è²»å¥—é¤é™é¡å……è¶³ (1GB å­˜å„², 2GB æµé‡)
- å…¨çƒ CDN è‡ªå‹•åŠ é€Ÿç…§ç‰‡è¼‰å…¥
- è©³è¦‹ [SUPABASE_SETUP.md](SUPABASE_SETUP.md)

### âœ… **æœ¬åœ°é–‹ç™¼ç’°å¢ƒå„ªåŒ–**
- è§£æ±º Docker ç·¨è­¯å•é¡Œï¼Œæ¨è–¦æœ¬åœ°é–‹ç™¼
- ä½¿ç”¨ `./start-dev.sh` ä¸€éµå•Ÿå‹•é–‹ç™¼ç’°å¢ƒ
- PostgreSQL é‹è¡Œåœ¨ Dockerï¼Œå¾Œç«¯+å‰ç«¯æœ¬åœ°é‹è¡Œ
- SQLx é›¢ç·šæ¨¡å¼ï¼ŒåŠ å¿«ç·¨è­¯é€Ÿåº¦
- å®Œæ•´çš„æ•¸æ“šåº«é·ç§»ç³»çµ±

## ğŸš€ å¿«é€Ÿé–‹å§‹

### ç’°å¢ƒè¦æ±‚
- Node.js 18+ (å‰ç«¯)
- Rust 1.70+ (å¾Œç«¯)
- PostgreSQL 15+ (æ•¸æ“šåº«)
- Docker & Docker Compose (ç”¨æ–¼æ•¸æ“šåº«)
- Supabase å¸³è™Ÿ (ç”¨æ–¼ç…§ç‰‡å­˜å„²)

### æœ¬åœ°é–‹ç™¼ç’°å¢ƒ (æ¨è–¦)

```bash
# 1. å…‹éš†é …ç›®
git clone <repository-url>
cd Twogether

# 2. è¨­ç½® Supabase å­˜å„²
# è«‹åƒè€ƒ SUPABASE_SETUP.md è©³ç´°æŒ‡å—
# ç„¶å¾Œæ›´æ–° start-dev.sh ä¸­çš„æ†‘è­‰

# 3. å•Ÿå‹•é–‹ç™¼ç’°å¢ƒ
./start-dev.sh

# è¨ªå•æ‡‰ç”¨
# å‰ç«¯: http://localhost:5173
# å¾Œç«¯ API: http://localhost:8080
# æ•¸æ“šåº«ç®¡ç†: http://localhost:5050 (pgAdmin)
```

### Docker Compose (æœ‰ç·¨è­¯å•é¡Œ)

âš ï¸ **æ³¨æ„**: Docker æ§‹å»ºç›®å‰æœ‰ Rust ä¾è³´å•é¡Œï¼Œå»ºè­°ä½¿ç”¨æœ¬åœ°é–‹ç™¼ç’°å¢ƒã€‚

```bash
# å¦‚æœè¦å˜—è©¦ Docker (å¯èƒ½å¤±æ•—)
docker-compose up --build
```

### æ‰‹å‹•å®‰è£

#### 1. æ•¸æ“šåº«è¨­ç½®
```bash
# å®‰è£ä¸¦å•Ÿå‹• PostgreSQL
createdb twogether_dev
```

#### 2. å¾Œç«¯è¨­ç½®
```bash
cd backend

# å®‰è£ SQLx CLI
cargo install sqlx-cli --features postgres

# è¨­ç½®ç’°å¢ƒè®Šé‡
export DATABASE_URL="postgresql://username:password@localhost:5432/twogether_dev"

# é‹è¡Œæ•¸æ“šåº«é·ç§»
sqlx migrate run

# å•Ÿå‹•å¾Œç«¯æœå‹™
cargo run
```

#### 3. å‰ç«¯è¨­ç½®
```bash
cd frontend

# å®‰è£ä¾è³´
npm install

# å•Ÿå‹•é–‹ç™¼æœå‹™å™¨
npm run dev
```

## ğŸš€ To start the development servers:

```bash
# Option 1: Use our convenient script
./scripts/dev-start.sh backend    # Terminal 1
./scripts/dev-start.sh frontend   # Terminal 2

# Option 2: Manual startup
cd backend && DATABASE_URL="postgresql://twogether:twogether_dev_password@localhost:5432/twogether_dev" cargo run
cd frontend && npm run dev
```

## ğŸ“‹ View Logs

### Backend Logs
```bash
# If running with cargo run - check the terminal where backend is running
# If using Docker Compose:
docker compose logs backend
docker compose logs -f backend  # Follow logs in real-time
```

### Frontend Logs  
```bash
# If running with npm run dev - check the terminal where frontend is running
# If using Docker Compose:
docker compose logs frontend
docker compose logs -f frontend  # Follow logs in real-time
```

### Database Logs
```bash
docker compose logs postgres
docker compose logs -f postgres  # Follow logs in real-time
```

### All Container Logs
```bash
docker compose logs           # All logs
docker compose logs -f        # Follow all logs in real-time
docker compose logs --tail=50 # Last 50 lines from all services
```

## ğŸ”§ Process Management

### Check Running Processes
```bash
# Check what's running on port 8080
lsof -i :8080

# Check all Twogether processes  
ps aux | grep twogether

# Check Docker containers
docker compose ps
```

### Kill Processes
```bash
# Kill specific process by PID
kill <PID>

# Kill all processes on port 8080
lsof -ti:8080 | xargs kill -9

# Kill by process name
pkill -f twogether-backend

# Stop Docker containers
docker compose down
```

### Troubleshooting "Address already in use"
```bash
# 1. Check what's using the port
lsof -i :8080

# 2. Kill the process
kill <PID_from_step_1>

# 3. Or kill all processes on port 8080
lsof -ti:8080 | xargs kill -9

# 4. Then restart your service
cd backend && DATABASE_URL="postgresql://twogether:twogether_dev_password@localhost:5432/twogether_dev" cargo run
```

## ğŸ“ é …ç›®çµæ§‹

```
Twogether/
â”œâ”€â”€ frontend/                 # React å‰ç«¯æ‡‰ç”¨
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ components/       # React çµ„ä»¶
â”‚   â”‚   â”œâ”€â”€ services/         # API æœå‹™å±¤
â”‚   â”‚   â””â”€â”€ App.tsx          # ä¸»æ‡‰ç”¨çµ„ä»¶
â”‚   â”œâ”€â”€ public/              # éœæ…‹è³‡æº
â”‚   â””â”€â”€ package.json         # å‰ç«¯ä¾è³´
â”œâ”€â”€ backend/                 # Rust å¾Œç«¯ API
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ routes/          # API è·¯ç”±
â”‚   â”‚   â”œâ”€â”€ models/          # æ•¸æ“šæ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ services/        # æ¥­å‹™é‚è¼¯
â”‚   â”‚   â””â”€â”€ main.rs          # å¾Œç«¯å…¥å£
â”‚   â”œâ”€â”€ migrations/          # æ•¸æ“šåº«é·ç§»
â”‚   â””â”€â”€ Cargo.toml           # å¾Œç«¯ä¾è³´
â”œâ”€â”€ docker-compose.yml       # é–‹ç™¼ç’°å¢ƒç·¨æ’
â””â”€â”€ README.md               # é …ç›®æ–‡æª”
```

## ğŸ”§ é–‹ç™¼æŒ‡å—

### API ç«¯é»

#### èªè­‰
- `POST /api/auth/register` - ç”¨æˆ¶è¨»å†Š
- `POST /api/auth/login` - ç”¨æˆ¶ç™»éŒ„
- `GET /api/auth/me` - ç²å–ç”¨æˆ¶ä¿¡æ¯

#### æ„›çš„æ™‚å…‰
- `GET /api/love-moments` - ç²å–è¨˜éŒ„åˆ—è¡¨
- `POST /api/love-moments` - å‰µå»ºæ–°è¨˜éŒ„
- `GET /api/love-moments/:id` - ç²å–å–®å€‹è¨˜éŒ„
- `GET /api/love-moments/stats` - ç²å–çµ±è¨ˆæ•¸æ“š

#### å…¶ä»–åŠŸèƒ½
- `GET /api/achievements` - ç²å–æˆå°±åˆ—è¡¨
- `GET /api/coins/balance` - ç²å–ç¡¬å¹£é¤˜é¡
- `POST /api/photos` - ä¸Šå‚³ç…§ç‰‡

### å‰ç«¯æ¶æ§‹ç‰¹é»

#### å®Œæ•´å¾Œç«¯ API é›†æˆ
```typescript
// å®Œå…¨ä½¿ç”¨å¾Œç«¯ API é€²è¡Œæ•¸æ“šç®¡ç†
const response = await apiClient.get('/love-moments');
return response.data.map(transformApiRecord);

// åŒ…å«éŒ¯èª¤è™•ç†å’Œç”¨æˆ¶å‹å¥½æç¤º
try {
  await apiService.createIntimateRecord(data);
} catch (error) {
  showNotification({
    type: 'warning',
    title: 'è¨˜éŒ„å¤±æ•—',
    message: 'ç„¡æ³•ä¿å­˜è¨˜éŒ„ï¼Œè«‹ç¨å¾Œå†è©¦'
  });
}
```

#### çµ„ä»¶åŒ–è¨­è¨ˆ
- `SettingsView.tsx` - è¨­ç½®é é¢çµ„ä»¶
- `RoleplayView.tsx` - è§’è‰²æ‰®æ¼”çµ„ä»¶
- é¿å…çµ„ä»¶å…§éƒ¨å®šç¾©ï¼Œé˜²æ­¢é‡è¤‡æ¸²æŸ“

### å¾Œç«¯æ¶æ§‹ç‰¹é»

#### é¡å‹å®‰å…¨çš„ SQL
```rust
// ç·¨è­¯æ™‚æª¢æŸ¥çš„ SQL æŸ¥è©¢
let moments = sqlx::query!(
    "SELECT * FROM love_moments WHERE couple_id = $1",
    couple_id
).fetch_all(&pool).await?;
```

#### ç¾ä»£ Rust ç•°æ­¥
```rust
// åŸºæ–¼ Tokio çš„ç•°æ­¥è™•ç†
#[tokio::main]
async fn main() -> Result<()> {
    let app = create_app().await?;
    axum::Server::bind(&addr).serve(app).await?;
}
```

## ğŸ¯ æ ¸å¿ƒåŠŸèƒ½æ¼”ç¤º

### 1. æ„›çš„æ™‚å…‰è¨˜éŒ„
- æ—¥æœŸæ™‚é–“é¸æ“‡
- å¿ƒæƒ…è¡¨æƒ…é¸æ“‡
- è©³ç´°æè¿°å’Œå‚™è¨»
- ç…§ç‰‡ä¸Šå‚³å’Œé è¦½
- åœ°é»å’ŒæŒçºŒæ™‚é–“è¨˜éŒ„

### 2. æ•¸æ“šå¯è¦–åŒ–
- æœˆåº¦çµ±è¨ˆåœ–è¡¨
- è¦ªå¯†åº¦è¶¨å‹¢åˆ†æ
- æˆå°±é€²åº¦è¿½è¹¤
- ç¡¬å¹£ç²å¾—æ­·å²

### 3. éŠæˆ²åŒ–å…ƒç´ 
- é€£çºŒè¨˜éŒ„çå‹µ
- æˆå°±å¾½ç« è§£é–
- æ„›æƒ…ç¡¬å¹£ç³»çµ±
- ç­‰ç´šæå‡æ©Ÿåˆ¶

## ğŸ”’ å®‰å…¨ç‰¹æ€§

- JWT èº«ä»½é©—è­‰
- PostgreSQL åƒæ•¸åŒ–æŸ¥è©¢é˜²æ­¢ SQL æ³¨å…¥
- CORS è·¨åŸŸä¿è­·
- å¯†ç¢¼å“ˆå¸Œå­˜å„²
- ç”¨æˆ¶æ•¸æ“šéš”é›¢

## ğŸ“Š æ€§èƒ½å„ªåŒ–

- React useCallback é˜²æ­¢ä¸å¿…è¦é‡æ¸²æŸ“
- PostgreSQL ç´¢å¼•å„ªåŒ–
- åœ–ç‰‡å£“ç¸®å’Œå„ªåŒ–
- ç•°æ­¥æ•¸æ“šåŠ è¼‰
- éŸ¿æ‡‰å¼åœ–ç‰‡è™•ç†

## ğŸ¤ è²¢ç»æŒ‡å—

1. Fork é …ç›®
2. å‰µå»ºåŠŸèƒ½åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. é–‹å•Ÿ Pull Request

## ğŸ“„ è¨±å¯è­‰

æœ¬é …ç›®ä½¿ç”¨ MIT è¨±å¯è­‰ - æŸ¥çœ‹ [LICENSE](LICENSE) æ–‡ä»¶äº†è§£è©³æƒ…ã€‚

## ğŸ™ è‡´è¬

- React ç¤¾å€æä¾›çš„å„ªç§€ç”Ÿæ…‹ç³»çµ±
- Rust ç¤¾å€çš„ Axum å’Œ SQLx é …ç›®
- Tailwind CSS çš„ç¾è§€è¨­è¨ˆç³»çµ±
- PostgreSQL çš„å¯é æ•¸æ“šå­˜å„²

---

**è®“æ„›æƒ…æ›´æœ‰è¶£ï¼Œè®“å›æ†¶æ›´çè²´** â¤ï¸ 

## ğŸ’ é…å°æµç¨‹èªªæ˜

### æ­¥é©Ÿ 1ï¼šç”¨æˆ¶è¨»å†Š/ç™»éŒ„
1. ç¬¬ä¸€å€‹ç”¨æˆ¶è¨»å†Šå¸³è™Ÿï¼ˆä¾‹å¦‚ï¼šç”¨æˆ¶Aï¼‰
2. ç™»éŒ„å¾Œæœƒçœ‹åˆ°æœªé…å°ç‹€æ…‹
3. åœ¨è¨­ç½®é é¢å¯ä»¥ç”Ÿæˆé…å°ç¢¼

### æ­¥é©Ÿ 2ï¼šç”Ÿæˆé…å°ç¢¼
1. ç”¨æˆ¶Aåœ¨è¨­ç½®é é¢é»æ“Šã€Œç”Ÿæˆé…å°ç¢¼ã€
2. ç³»çµ±ç”Ÿæˆ8ä½å­—æ¯æ•¸å­—çµ„åˆï¼ˆä¾‹å¦‚ï¼šX5RX6S7Dï¼‰
3. é…å°ç¢¼æœ‰æ•ˆæœŸ24å°æ™‚
4. å°‡é…å°ç¢¼åˆ†äº«çµ¦ä¼´ä¾¶ï¼ˆç”¨æˆ¶Bï¼‰

### æ­¥é©Ÿ 3ï¼šä¼´ä¾¶é…å°
1. ç”¨æˆ¶Béœ€è¦å…ˆè¨»å†Šè‡ªå·±çš„å¸³è™Ÿ
2. ç™»éŒ„å¾Œåœ¨è¨­ç½®é é¢è¼¸å…¥é…å°ç¢¼
3. é»æ“Šã€Œé…å°ã€æŒ‰éˆ•
4. ç³»çµ±é©—è­‰é…å°ç¢¼ä¸¦å»ºç«‹ä¼´ä¾¶é—œä¿‚

### é æœŸè¡Œç‚º
- âœ… é…å°æˆåŠŸå¾Œï¼Œå…©å€‹ç”¨æˆ¶éƒ½æœƒçœ‹åˆ°ã€Œå·²èˆ‡ä¼´ä¾¶é€£æ¥ã€ç‹€æ…‹
- âœ… å¯ä»¥é–‹å§‹è¨˜éŒ„å’Œåˆ†äº«æ„›çš„æ™‚å…‰
- âœ… æ•¸æ“šæœƒåœ¨å…©å€‹å¸³è™Ÿé–“åŒæ­¥
- âœ… é…å°ç¢¼æœƒè¢«æ¨™è¨˜ç‚ºå·²ä½¿ç”¨

### å¸¸è¦‹å•é¡Œæ’æŸ¥

#### å•é¡Œï¼šé…å°å¾Œé¡¯ç¤ºç™»éŒ„é é¢
**åŸå› **ï¼šå‰ç«¯åœ¨é…å°æˆåŠŸå¾Œæ²’æœ‰æ­£ç¢ºæ›´æ–°èªè­‰ç‹€æ…‹
**è§£æ±ºæ–¹æ¡ˆ**ï¼š
1. æª¢æŸ¥ç€è¦½å™¨æ§åˆ¶å°æ˜¯å¦æœ‰éŒ¯èª¤
2. ç¢ºèª API éŸ¿æ‡‰åŒ…å«æ­£ç¢ºçš„ç”¨æˆ¶ä¿¡æ¯
3. æª¢æŸ¥ localStorage ä¸­çš„èªè­‰ç‹€æ…‹
4. é‡æ–°åˆ·æ–°é é¢å˜—è©¦

#### å•é¡Œï¼šé…å°ç¢¼ç„¡æ•ˆ
**å¯èƒ½åŸå› **ï¼š
- é…å°ç¢¼å·²éæœŸï¼ˆ24å°æ™‚å¾Œå¤±æ•ˆï¼‰
- é…å°ç¢¼å·²è¢«ä½¿ç”¨
- è¼¸å…¥éŒ¯èª¤ï¼ˆå€åˆ†å¤§å°å¯«ï¼‰
- ç”Ÿæˆé…å°ç¢¼çš„ç”¨æˆ¶å·²æœ‰ä¼´ä¾¶

#### å•é¡Œï¼šç„¡æ³•ç”Ÿæˆé…å°ç¢¼
**å¯èƒ½åŸå› **ï¼š
- ç”¨æˆ¶å·²æœ‰é…å°çš„ä¼´ä¾¶
- å·²æœ‰æœªéæœŸçš„é…å°ç¢¼å­˜åœ¨
- èªè­‰ token ç„¡æ•ˆ

## ğŸ§ª æ¸¬è©¦ç”¨ä¾‹

### å¾Œç«¯æ¸¬è©¦

#### é…å°ç¢¼ç”Ÿæˆæ¸¬è©¦
```bash
# æ¸¬è©¦ç”Ÿæˆé…å°ç¢¼ï¼ˆéœ€è¦æœ‰æ•ˆçš„ JWT tokenï¼‰
curl -X POST http://localhost:8080/api/couples/pairing-code \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer <your-jwt-token>"

# é æœŸéŸ¿æ‡‰ï¼š
{
  "code": "X5RX6S7D",
  "expires_at": "2025-07-04T13:28:47Z"
}
```

#### ä½¿ç”¨é…å°ç¢¼å‰µå»ºä¼´ä¾¶é—œä¿‚
```bash
# æ¸¬è©¦ä½¿ç”¨é…å°ç¢¼é…å°
curl -X POST http://localhost:8080/api/couples \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer <partner-jwt-token>" \
  -d '{"pairing_code": "X5RX6S7D"}'

# é æœŸéŸ¿æ‡‰ï¼š
{
  "id": "uuid",
  "couple_name": null,
  "anniversary_date": null,
  "user1_nickname": "ç”¨æˆ¶Aæš±ç¨±",
  "user2_nickname": "ç”¨æˆ¶Bæš±ç¨±",
  "created_at": "2025-07-03T13:28:47Z",
  "pairing_code": null
}
```

#### éŒ¯èª¤æƒ…æ³æ¸¬è©¦
```bash
# æ¸¬è©¦éæœŸ/ç„¡æ•ˆé…å°ç¢¼
curl -X POST http://localhost:8080/api/couples \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer <jwt-token>" \
  -d '{"pairing_code": "INVALID1"}'

# é æœŸéŸ¿æ‡‰ï¼š
{
  "error": {
    "code": "NOT_FOUND",
    "message": "é…å°ç¢¼ç„¡æ•ˆæˆ–å·²éæœŸ"
  }
}
```

### å‰ç«¯æ¸¬è©¦

#### æ‰‹å‹•æ¸¬è©¦æµç¨‹
1. **ç”¨æˆ¶Aè¨»å†Šæ¸¬è©¦**
   - éƒµç®±ï¼š`user-a@test.com`
   - æš±ç¨±ï¼š`æ¸¬è©¦ç”¨æˆ¶A`
   - å¯†ç¢¼ï¼š`password123`

2. **ç”Ÿæˆé…å°ç¢¼**
   - ç™»éŒ„å¾Œé€²å…¥è¨­ç½®é é¢
   - é»æ“Šã€Œç”Ÿæˆé…å°ç¢¼ã€
   - é©—è­‰é…å°ç¢¼é¡¯ç¤º

3. **ç”¨æˆ¶Bè¨»å†Šæ¸¬è©¦**
   - éƒµç®±ï¼š`user-b@test.com`
   - æš±ç¨±ï¼š`æ¸¬è©¦ç”¨æˆ¶B`
   - å¯†ç¢¼ï¼š`password123`

4. **é…å°æ¸¬è©¦**
   - ç”¨æˆ¶Bç™»éŒ„å¾Œé€²å…¥è¨­ç½®é é¢
   - è¼¸å…¥ç”¨æˆ¶Açš„é…å°ç¢¼
   - é»æ“Šã€Œé…å°ã€
   - é©—è­‰é…å°æˆåŠŸæ¶ˆæ¯
   - æª¢æŸ¥æ˜¯å¦æ­£ç¢ºæ›´æ–°èªè­‰ç‹€æ…‹

#### è‡ªå‹•åŒ–æ¸¬è©¦
```javascript
// é…å°æµç¨‹ç«¯åˆ°ç«¯æ¸¬è©¦
describe('Pairing Flow', () => {
  it('should complete pairing process successfully', async () => {
    // 1. ç”¨æˆ¶Aè¨»å†Š
    const userA = await registerUser('user-a@test.com', 'æ¸¬è©¦ç”¨æˆ¶A', 'password123');
    
    // 2. ç”Ÿæˆé…å°ç¢¼
    const pairingCode = await generatePairingCode(userA.token);
    expect(pairingCode.code).toMatch(/^[A-Z0-9]{8}$/);
    
    // 3. ç”¨æˆ¶Bè¨»å†Š
    const userB = await registerUser('user-b@test.com', 'æ¸¬è©¦ç”¨æˆ¶B', 'password123');
    
    // 4. ä½¿ç”¨é…å°ç¢¼é…å°
    const coupleResult = await pairWithCode(userB.token, pairingCode.code);
    expect(coupleResult.user1_nickname).toBe('æ¸¬è©¦ç”¨æˆ¶A');
    expect(coupleResult.user2_nickname).toBe('æ¸¬è©¦ç”¨æˆ¶B');
    
    // 5. é©—è­‰é…å°ç‹€æ…‹
    const userACouple = await getCouple(userA.token);
    const userBCouple = await getCouple(userB.token);
    expect(userACouple.id).toBe(userBCouple.id);
  });
});
```